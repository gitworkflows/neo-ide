---
stage: Create
group: remote development
info: To determine the technical writer assigned to the Stage/Group associated with this page, see https://about.gitlab.com/handbook/product/ux/technical-writing/#assignments
---

# Web IDE Releases

## Overview

This document provides comprehensive instructions for releasing the Web IDE
components, explains the versioning convention for release artifacts, and describes
how these artifacts function in production environments. Understanding this process
is essential for maintaining and updating the Web IDE infrastructure.

## How to Release

The following sections describe the release process for various artifacts produced by
the Web IDE project.

### Web IDE Main Artifacts

To release a new version of the Web IDE artifacts used by the GitLab application:

1. Go to https://gitlab.com/gitlab-org/gitlab-web-ide/-/commits/main.
1. Open the pipeline of the target commit to release.
1. Wait for the pipeline to finish successfully.
1. Run the `publish-development-package` manual job.
1. When `publish-development-package` finishes successfully, create a tag in the repository for the version just published. See [this tag](https://gitlab.com/gitlab-org/gitlab-web-ide/-/tags/0.0.1-dev-20220811191150) for an example.

After the `publish-development-package` job completes without errors, the `deploy-assets-production` job will deploy the Web IDE's VSCode workbench assets to `.cdn.web-ide.gitlab-static.net`.

**NOTE:** It's crucial that both the `publish-development-package` and `deploy-assets-production` jobs pass successfully before updating the Web IDE version in `gitlab-org/gitlab`.

### Web IDE VSCode Color Theme

To release the VSCode color theme:

1. Go to https://gitlab.com/gitlab-org/gitlab-web-ide/-/commits/main.
1. Open the pipeline of the target commit to release.
1. Wait for the pipeline to finish successfully.
1. Run the `publish-gitlab-vscode-theme-package` manual job.

The `publish-gitlab-vscode-theme-package` CI job needs to have both _write registry_ and _write repository_ permissions. We are dogfooding the `allow_push_repository_for_job_token` feature flag for this project, allowing us to use `CI_JOB_TOKEN` without managing a separate project token.

See [the docs for CI job token](https://docs.gitlab.com/ee/ci/jobs/ci_job_token.html#git-push-to-your-project-repository) for more details.

### Updating the Web IDE in the GitLab Application

To update the Web IDE in the GitLab application, bump the `@gitlab/web-ide` npm package version in the [gitlab-org/gitlab](https://gitlab.com/gitlab-org/gitlab/-/blob/master/package.json?ref_type=heads#L71) repository.

### Security releases

Read the [security releases](./security-releases.md) documentation for a detailed
guide on how to release and manage security fixes in the Web IDE.

## Versioning

All release artifacts use the versioning convention `0.0.1-dev-$TIMESTAMP`, where `$TIMESTAMP` is generated by the `create-development-package` job in the CI environment. For example: `0.0.1-dev-20220811191150`. The command used to generate `$TIMESTAMP` is `date '+%Y%m%d%H%M%S'`.

## Cloudflare (cdn.web-ide.gitlab-static.net)

The Web IDE deploys the GitLab VSCode Fork static assets and built-in VSCode
extensions in an external HTTP server hosted on Cloudflare and implemented using the
Cloudflare Worker service. The goal of hosting these assets in a separate HTTP server
is to sandbox the execution of the VSCode workbench and VSCode extensions using the
web browser's [same-origin policy](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy). This sandbox prevents 3rd-party code from having
unrestricted access to a GitLab user account.

### Staging and Production Environments

There are two static assets environments:

- Production: `*.cdn.web-ide.gitlab-static.net`
- Staging: `*.staging.cdn.web-ide.gitlab-static.net`

### How to Deploy the Cloudflare Worker

The Cloudflare worker is automatically deployed to the **production** environment
when any file in the directory `packages/cloudflare` changes in the `main` branch.
To deploy the Cloudflare worker to the **staging** environment, start the
`deploy-cloudflare-worker-staging` job from any merge request.

The `deploy-cloudflare-worker-staging` job will overwrite the previous deployment
of the Cloudflare worker in the staging environment.

### How to Deploy Static Assets

The Web IDE's VSCode workbench static assets are automatically deployed to the
**production** environment after the `publish-development-package` job finishes in the
`main` branch. To deploy the static assets to the **staging** environment, start the
`deploy-assets-staging` job from any merge request. The assets deployed to the
staging environment are previously built by the `create-development-package` job
in that merge request.

Assets are deployed to `production` and `staging` are versioned using the
`0.0.1-dev-$TIMESTAMP` convention. Unlike the CloudFlare worker deployment, new assets deployments
do not overwrite previous ones.

### Local Testing

You can use the staging environment to test new releases of the GitLab VSCode Fork or
changes to the Cloudflare worker implementation.

After running the jobs based on your use case (`deploy-cloudflare-worker-staging` and/or `deploy-assets-staging`) from your merge request, you can then use the Cloudflare assets staging environment by updating the workbench and extensions host URLs to the staging endpoint: `staging.cdn.web-ide.gitlab-static.net`

**Example App**:

In the Example App, the workbench URLs are set in `config/.env.local`.

```bash
# env.local file
VITE_WORKBENCH_BASE_URL_HTTPS="https://workbench.staging.cdn.web-ide.gitlab-static.net/gitlab-web-ide-vscode-workbench-<version>"
VITE_EXTENSIONS_HOST_BASE_URL_HTTPS="https://{{uuid}}.staging.cdn.web-ide.gitlab-static.net/gitlab-web-ide-vscode-workbench-<version>/vscode"
```

**GitLab Rails app**:

In the GitLab Rails app, the workbench URLs are set in `buildExtensionHostUrl` in `app/assets/javascripts/ide/lib/gitlab_web_ide/get_web_ide_workbench_config.js`.

## Release Artifacts

### @gitlab/web-ide npm package

This npm package contains the functionality to handle OAuth authentication flow and
load the Web IDE's VSCode workbench. It is imported by the GitLab application to
provide Web IDE functionality within the GitLab interface.

### .cdn.web-ide.gitlab-static.net Assets

These assets include the Web IDE's VSCode workbench static files (JavaScript, CSS,
HTML, WASM) that are hosted on Cloudflare. They are loaded in an iframe by the
`@gitlab/web-ide` npm package and provide the core editor functionality of the Web IDE.

### GitLab VSCode Theme VSCode Extension

A VSCode extension file (.vsix) that contains the color themes used by the Web IDE. It
is bundled as a built-in extension in the Web IDE to provide consistent visual styling.

## Web IDE Runtime Architecture

The following high-level container diagram describes how the Web IDE artifacts
interact in production.

```mermaid
flowchart TD
    subgraph gitlab-instance-boundary[" "]
        B["gitlab.com<br>[Rails application]<br><br>GitLab monolith web application that<br>embeds the Web IDE and provides OAuth authentication<br>and GraphQL/REST APIs."]
        C["@gitlab/web-ide<br>[npm package]<br><br>Contains functionality to handle OAuth authentication flow<br>and load the Web IDE's VSCode workbench"]
    end
    A["GitLab User<br>[Person]<br><br>A registered user account in a GitLab instance<br> with read/write access to one or more projects. <br>"] -- "Opens a project in the Web IDE, edits<br>one or more files, and commits them to the repository." --> B
    C -- "Loads the Web IDE's VSCode workbench in an<br>iframe and provides OAuth access tokens." --> n1["*.cdn.web-ide.gitlab-static.net<br>[Cloudflare worker]<br><br>Hosts the Web IDE's VSCode workbench static assets<br>(js, css, html, wasm) and built-in VSCode extensions.<br> * represents a wildcard domain."]
    B -- Imports Web IDE npm package in the Web IDE<br>page to load Web IDE's VSCode workbench --> C
    n1 -- "Built-in VSCode extensions like the Web IDE<br>source control and the GitLab VSCode extension send REST/GraphQL API<br>requests authenticated by the OAuth access token provided by<br>the @gitlab/web-ide npm package." --> B

    classDef user-class stroke:#052e56,fill:#08427b,color:#ffffff
    classDef container-class stroke:#0b4884,fill:#1168bd,color:#ffffff
    classDef boundary-class fill:none,stroke:#CCC,stroke-width:2px,color:#fff,stroke-dasharray:5 5

    class A user-class
    class B,C,n1 container-class
    class gitlab-instance-boundary boundary-class
```

## Glossary

- **Web IDE**: The integrated development environment within GitLab that allows users to edit code directly in the browser.
- **GitLab VSCode Fork**: The fork of Visual Studio Code, the open-source code editor that
  forms the basis of the Web IDE.
- **Cloudflare Worker**: A serverless execution environment that allows you to create
  an HTTP server without configuring or maintaining infrastructure.
- **OAuth**: An open standard for access delegation, commonly used as a way for internet
  users to grant websites or applications access to their information on other websites
  but without giving them the passwords.
- **Same-origin policy**: A critical security mechanism that restricts how a document or
  script loaded from one origin can interact with a resource from another origin.
